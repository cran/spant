<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>ABfit baseline options</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">ABfit baseline options</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>A good baseline estimate is a prerequisite for accurate metabolite quantitation. The default MRS analysis algorithm in spant (ABfit) is designed to find accurate baseline estimates by automatically adapting the level of baseline flexibility to match the data complexity. This process is inevitably a balancing act between a baseline that is too smooth (resulting in greater bias), and too flexible (resulting in greater variance). Therefore, ABfit has a number of fitting options to adjust the baseline according to user preference. In this vignette the most common adjustments are demonstrated.</p>
</div>
<div id="default-analysis" class="section level2">
<h2>Default analysis</h2>
<p>Load the spant analysis package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spant)</span></code></pre></div>
<p>Read an example dataset from file and simulate matching basis set:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fname    <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;philips_spar_sdat_WS.SDAT&quot;</span>, <span class="at">package =</span> <span class="st">&quot;spant&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mrs_data <span class="ot">&lt;-</span> <span class="fu">read_mrs</span>(fname, <span class="at">format =</span> <span class="st">&quot;spar_sdat&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>basis    <span class="ot">&lt;-</span> <span class="fu">sim_basis_1h_brain_press</span>(mrs_data)</span></code></pre></div>
<p>Run a default ABfit analysis and plot the result:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fit_res <span class="ot">&lt;-</span> <span class="fu">fit_mrs</span>(mrs_data, basis)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The above fit looks good, with a smooth baseline and no significant signals in the residual (top trace) above the noise level. We can find the automatically determined level of baseline smoothness by inspecting the results table in the <code>fit_res</code> object:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fit_res<span class="sc">$</span>res_tab<span class="sc">$</span>bl_ed_pppm</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.364083</span></span></code></pre></div>
<p>The baseline flexibility was found to be 2.4 ED per ppm, where ED is the effective dimension – analogous to the number of spline functions required per ppm. Whilst the automated fit looks reasonable at first glance, let’s try and convince ourselves we can’t do better with manual adjustments to the algorithm.</p>
</div>
<div id="custom-analyses" class="section level2">
<h2>Custom analyses</h2>
<p>Changing the default behaviour of ABfit is achieved by supplying an options structure to the <code>fit_mrs</code> function. The <code>abfit_opts</code> function generates the default fitting options, which may be modified by supplying arguments. To manually specify the baseline flexibility we set the <code>auto_bl_flex</code> option to <code>FALSE</code> and set the <code>bl_ed_pppm</code> option to the desired level. A greater value results in more baseline flexibility, let’s try a value of 8 ED ppm:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>opts    <span class="ot">&lt;-</span> <span class="fu">abfit_opts</span>(<span class="at">auto_bl_flex =</span> <span class="cn">FALSE</span>, <span class="at">bl_ed_pppm =</span> <span class="dv">8</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fit_res <span class="ot">&lt;-</span> <span class="fu">fit_mrs</span>(mrs_data, basis, <span class="at">opts =</span> opts)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The baseline is clearly more flexible, resulting in a slightly improved residual, however some baseline features are likely to be due to instability from noise, rather than true spectral features. For the next analysis let’s investigate 1 ED pppm:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>opts    <span class="ot">&lt;-</span> <span class="fu">abfit_opts</span>(<span class="at">auto_bl_flex =</span> <span class="cn">FALSE</span>, <span class="at">bl_ed_pppm =</span> <span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fit_res <span class="ot">&lt;-</span> <span class="fu">fit_mrs</span>(mrs_data, basis, <span class="at">opts =</span> opts)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now we have a much smoother (almost linear) baseline, which comes at the cost of having broad unmodelled signals in the residual – ultimately resulting in biased metabolite levels. An alternative to manually specifying a fixed level of baseline flexibility is to adjust the criterion used for automated estimation. The <code>aic_smoothing_factor</code> can be set to a smaller value (default = 5) to encourage more flexible baselines, whilst still being adaptive to any broad spectral features:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>opts    <span class="ot">&lt;-</span> <span class="fu">abfit_opts</span>(<span class="at">aic_smoothing_factor =</span> <span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fit_res <span class="ot">&lt;-</span> <span class="fu">fit_mrs</span>(mrs_data, basis, <span class="at">opts =</span> opts)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be informative to visualise the individual spline components used for baseline modelling by saving these in the results object:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>opts    <span class="ot">&lt;-</span> <span class="fu">abfit_opts</span>(<span class="at">export_sp_fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fit_res <span class="ot">&lt;-</span> <span class="fu">fit_mrs</span>(mrs_data, basis, <span class="at">opts =</span> opts)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stackplot</span>(fit_res, <span class="at">omit_signals =</span> basis<span class="sc">$</span>names)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The default number of spline functions for ABfit is 15 per PPM which may be verified from the above plot. Let’s try increasing to 25:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>opts    <span class="ot">&lt;-</span> <span class="fu">abfit_opts</span>(<span class="at">export_sp_fit =</span> <span class="cn">TRUE</span>, <span class="at">bl_comps_pppm =</span> <span class="dv">25</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fit_res <span class="ot">&lt;-</span> <span class="fu">fit_mrs</span>(mrs_data, basis, <span class="at">opts =</span> opts)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stackplot</span>(fit_res, <span class="at">omit_signals =</span> basis<span class="sc">$</span>names)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Clearly the density of spline functions has increased, however the baseline smoothness remains very close to the default. The general principle for ABfit (derived from P-splines) is to over specify the number of baseline modelling spline functions, and rely on a penalty factor to encourage smoothness.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fit_res<span class="sc">$</span>res_tab<span class="sc">$</span>bl_ed_pppm</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.276356</span></span></code></pre></div>
<p>Inspecting the automatically determined level of baseline flexibility shows the ED per ppm value remains very close to the default analysis despite the change in spline function density – precisely the desired behaviour.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
