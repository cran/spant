<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2017-08-09" />

<title>Introduction to spant</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to spant</h1>
<h4 class="date"><em>2017-08-09</em></h4>



<div id="reading-raw-data-and-plotting" class="section level2">
<h2>Reading raw data and plotting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(spant)
fname &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;philips_spar_sdat_WS.SDAT&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;spant&quot;</span>)

<span class="co"># import raw data</span>
mrs_data &lt;-<span class="st"> </span><span class="kw">read_mrs</span>(fname, <span class="dt">format =</span> <span class="st">&quot;spar_sdat&quot;</span>)

<span class="co"># output basic data structure</span>
<span class="kw">print</span>(mrs_data)</code></pre></div>
<pre><code>## MRS Data Parameters
## ----------------------------------
## Trans. freq (MHz)       : 127.7861
## FID data points         : 1024
## X,Y,Z dimensions        : 1x1x1
## Dynamics                : 1
## Coils                   : 1
## Voxel resolution (mm)   : 20x20x20
## Sampling frequency (Hz) : 2000
## Reference freq. (ppm)   : 4.65
## Spectral domain         : FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot data in the frequency domain</span>
<span class="kw">plot</span>(mrs_data, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="basic-preprocessing" class="section level2">
<h2>Basic preprocessing</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># apply water filter and align to tNAA resonance</span>
mrs_proc &lt;-<span class="st"> </span><span class="kw">hsvd_filt</span>(mrs_data)
mrs_proc &lt;-<span class="st"> </span><span class="kw">align</span>(mrs_proc, <span class="fl">2.01</span>)
<span class="kw">plot</span>(mrs_proc, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAGACAMAAABC/kH9AAAAWlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQZgCQtpCQ2/+2ZgC225C2///bkDrb////tmb/trb/25D//7b//9v///9uL0JRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANr0lEQVR4nO2dDWOsJhaGT2+bbpPdTbpN7+xsEv//31y/BQQF5Yzw5n3azjiMHpBHEJVJpSHQyNUFILpQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOD7BQiolVnDmg4g8CAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeC81FkHVFwPoqsIwrOR5F1RMH5KLKOKDgfRdYRBeejyDqi4HwUWUcUnI8i64iC8+GdHnM1FJwPCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgZHSqwlCs4HBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4FYyNF1hIFZ4OCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwZGmxGqi4GxQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDYyvxQFBeeCgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGh4GtR3wEKvhYKTk+rCgpOT6sKCk5PqwoKTk+rCgpOT6sKCk5PqwrtHZCH5JLO9xGsvAcUfDEUnJ5WFRScnlYVFJyeVhUUnJ5WFRScnlYVFJyeVhUUnJ5WFRScnqaDTk6ivQcUHAsFZ6U4wUpdKQUfSFOBgvNCwdkyWF5L4vsIVt4FCo6EgvNCwfkyaCg4AgrOS3mCdbKi4ANpKlBwXig4XwYNBUdAwXkpTbCWCAo+kKZB5YLLM0zB+TIw3sqBgrPFt96LgYKzxbfei4GCs8W33ouBgrPFt96LgYKzxbfei4GCs8W33ouBgrPFt96LgYKzxbfei4GCs8W33ouhQMEqeVHwgTQNKDgzoIJXISj4QJoGFJwZCs4DBUdCwZkpTLBkyssNoTV2W2VIwdtQcG5QBTsxKPhImgKZBK+mZlLwkTQFNAVr7oOsFkqBgrNAwZFQcG4oOAviWSoDCs4CBUdCwbmh4ById7EIKDgHFBwLBecGVbAThIKPpClAwbmh4BxQcCySJzMKnqlT8N4KFDxTpeDdP5ZGwTMUnAEJLJcApGBZxaDgI2kKUHBuKPg0QsHxVClYKDgaCs5NjYJXY2RflIcJdkpDwZvUKXjj4+WUJVi2M1u+puBYKPgsFJyAR7BnmYIT+B6C4wbnh3CDUvAWe4JnURQcCwWfhIJT8AkW41sKTqZIwWZuhQtexaTgLSg4O6ULFs9y0YJLM1yX4FkdBccCK9g3FFfYCQpOwid4+WAI3i4PBS8gCl53yGqCPREpeANXsFDwWQoX3F0kiZFagmBP4NDXBVC4YMvmtYLFt0DBabiVaL1ZI+grBIsTmIKTCQhenF4peO5OZE6g4EQcwdZg+nLBzVrwdTUVDQUnlM0R7J++S8FhxFkqSbCR8zzY88aj4DDiLBYt2H8GpuAt9gUbHeVeGCXBc9sNBaPgMGHBplgKTqFUwUubnT7O2goQHLhCOp2JAiULtj+K874XRlVwaIR1MhMFKDilbEv/QcEHEOfDluCtAlGwAQWnFI6CT+EI9n68WrDMHyk4GTsPKUqwk/uG4MIMFyzY+VSY4HAsCg6xJXhVs7sV7BF8Yi8o+DzbWSQLNtfIJlgo+Dhxgve7W03By2cKTmXnbyO5314iOCn/MihG8F4GFHyMagTHr1++4EceAtUKDm0gmQWHTvm7l2kb31PwiQ1E1jbdAdqBbDIK3rhHogCaYGlOC7ZavjsX+njJzKAp0Q7lsb3iFYLT44cEe/pjCj6WlpPjnWc4ce01JhexBQ/bUPBZChJsNX11wZ5+JiqP2LXLEHzooD4gOCYbMbeTZnsCVnzBvBksK0vi4Lo2wUeuHHaLeUiwNI5gO+lwybwZNOat9ZSjPH7dQgRn2GjdlZYoeAhpFGgaxKX1ExRsfUgU7I7Dk08g/tO2SLMIFjMxVfDWjCFvWQ6m5SH5FDdvuAqTQbAssRrXQlrJ3G1GteIItjqJyHxShgVFCD4WfC14NY9rvWbU6XEl+EDRVgeFNPOQbR5zTIWe5CYJjlu5AMFH7826MsU9VNIFO7OuNQQ3K8EiiRmJP4PgyofTshBfVM+WThgn0AHBdk0f32lPtzQJNjISKzE6x+Xwi1i9YsHWHro1NaY5C7tdtCX4xD6vT5KL0cYQnFY+e516BB8Nvn6wIO4K42pu0kZZjKWT++y5oWFd9R6u5+8k2DFblmAx9y1ScIoziRmgFiH48KY7s6SnSk0XfOa4m0NMgperGs8fv94oQzDwEgJc8GJhS7DzfCiuKCeGBksIaeYLobXgQPT9TI2hRQWCz8QdLynDYTyCtzJ0BZ8omhFk+sfJIhhdgh/cNHzB8+tGa3Cb4iWCI6bre0uxIzjGcP2CN1yM3+wLXvfzeSZOydR/WEOtvY1kfveWoh7BGQYyY5htwbY5b5WtV8sj+MipfHn+sC94v5wXC87TTIJhfDOq/FXmHmz5BB8INI0dKHgvzP7fGpwNuFGyTF7eGABubybN8q8v5rz4HQRv7WSdgo0z92rj1TVfuYIPPwj2BUpZ3f3gF3y2VGewbsI6x12xgtfHYq7fcBx5Hm8Ma8VeMFa6kpDgxhW8U9KHCV5byCY4tXBG17GMY9x+/mrBE6FJtqu0QIEfIrhvMj7BZ4KewBIsfsGlYM1B8BZRXfBuxQSG89cLNq9DChY8lDV4xaUmWMJfuSt6r+gurNB5lGqe0AoVbMzD9JdQ5hU3vo1PW75c/i8VnpXtE4d3wHyl4OkGcfmCm3lKXrCPkWW1wJcJadYDr8BUVUfnXL6IbB5EnYJDBcwl2O3UfP3cJNgcGgS68ivrcxS8O0AtgYhJtVv3LOMFr6YAepy7bSP4JCV4QnkQtQneKZyaYCeyOKuJVbjSBK9GCqUSUVnh3zpEC561iRg9wrw0phmPP43R3zosBacQeQl3WrB5ZjUF2+12abBLL70Ke/j3Ktm4vAAJnPgRQ0IXbWQkjTF1W5yT/CxYnMKJ6fr6+i111OwhQfDql9aHBDdiC5476c0wTvu/un6vzj+ByKKuh7yBbSMEzzfQ/KfYQJh5EwpWwTfgThJsdb9uDxxXgqlLv76DvLwA+SlAsN2zk8xMXqZKbo4KNhZSW/ByGicqOGOiNMHrj4c9UbASeQSTYrHuS0TMK91II0Vi3zCmYDiWq9DQDWoKrhrjNgMFI2JfDVMwHPb0PAqGg4LBkY1PaWmkSCj4W0HB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBECyaVckJ6XpjDw3KgYPAcKBg8BwoGz4GCwXOgYPAcKBg8BwoGz4GCwXOgYPAceN8ZHAoGh4LBcQV/vnRPJX5TzvX91/9qhr+J/PKXZgZfb20lPWvm0PLxj58ZoriCP35XrZmBu6gKvv342dw1DX+9tdFvys3g8+WHhuB7lqjbtL2EpuDPl+fOgWL1fzy9NsNxpMddREXwTbt37vL49U/dLrpRFjyg2knc5TlPW3MFv/+hfnZpzwLK5+CWm+5JuONdubNTEfz50lX9u6bhr7dn7UFW179pD4G6NqacgUoLzhg6wK2Vq9+Cv97UjyHtc4Ci4GEQoUM/TNcXrHuGfED71RWseK10GycA6h1CA5oHabcX6n51BA/Von6tpNqCH7APN/Xjs9Fqwe/dmUV1kNXnotpFd9G7oZwaH0/67Veti35/QPepfQ7W3ofxNKN8JaZ4DiY4UDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8Hg1CO4n2zePYX6fNl6UuT9dk7s5/V3T2mmlP79JvJ8nzb7ett7EPX5zwfMHc9FNYKHOTLvv/y1I9jLtMm9f4roBukmUi+fIyYO3/VnHGWjFsHjDJxuLt0Jwf10hn7OtC341Wzj+9H3G3k51CL4Njaa//1sFfzraXigfxvmcH88/bvteZ8/+tRB0G38gdX46H+0ZsyGn4K033Tbydj9D4/ZP37/z9MQeV4ws1hKUwGVCDZ/qPD50v0yaPyvmz3z8dT/VKg1c/vxczip9p3wc99ib0aHvMx1nYJMrXduuN0mrcfXvjs3Fows1Kds5qQSwf3vjczltsse0toW10+RGl9eB1vD2v1oqOvcZ31dE+xnwixBbMFjerd920zthSkL7SmbWalS8NDpDs2oreulzkdjZv3fl357oB2NT226fVkLnv218e2F5cUsTuFUItjuokfB0wzrteBpXnd7Kv7x99OrO3J6H3tyj+AhTL9953VeoGBlpmFNe0K0W3BjVrzTgucvRn1T+n0494ZbMAU/HPcyaXSzfGcKnuq/n3h6X7roqR+4h1uwcQ5+n87B/cKrk8+D9/8wtQgebnT0P62f3Aw/EX13mtc8im5tDo1XltsYw58WuE8pluCxTQ6j6Hb7efA8LFhuOYpWoL/LON+qnG4xdmPiteDpOrj/Yx3vY4c8B+nsuILbK2bjOvhpvNI2FqwXXgfXizUKD3TFB+6lXQYFu9x+2xXMe9E18/X2uiOYT5NIOVAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOP8Hgp2FAjZZ54QAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="basis-simulation" class="section level2">
<h2>Basis simulation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulate a typical basis set for short TE brain analysis</span>
basis &lt;-<span class="st"> </span><span class="kw">sim_basis_1h_brain_press</span>(mrs_proc)

<span class="co"># output basis info</span>
<span class="kw">print</span>(basis)</code></pre></div>
<pre><code>## Basis set parameters
## -------------------------------
## Trans. freq (MHz)       : 127.786142
## Data points             : 1024
## Sampling frequency (Hz) : 2000
## Elements                : 27
## 
## Names
## -------------------------------
## -CrCH2,Ala,Asp,Cr,GABA,Glc,Gln,
## GSH,Glu,GPC,Ins,Lac,Lip09,
## Lip13a,Lip13b,Lip20,MM09,MM12,
## MM14,MM17,MM20,NAA,NAAG,PCh,
## PCr,sIns,Tau</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot basis signals</span>
<span class="kw">stackplot</span>(basis, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="fitting" class="section level2">
<h2>Fitting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># perform VARPRO fitting to processed data</span>
fit_res &lt;-<span class="st"> </span><span class="kw">fit_mrs</span>(mrs_proc, basis)</code></pre></div>
<pre><code>## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |=================================================================| 100%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the fit estimate, residual and baseline</span>
<span class="kw">plot</span>(fit_res, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
