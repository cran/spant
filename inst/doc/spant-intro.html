<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2018-01-31" />

<title>Introduction to spant</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to spant</h1>
<h4 class="date"><em>2018-01-31</em></h4>



<div id="reading-raw-data-and-plotting" class="section level2">
<h2>Reading raw data and plotting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(spant)
fname &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;philips_spar_sdat_WS.SDAT&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;spant&quot;</span>)

<span class="co"># import raw data</span>
mrs_data &lt;-<span class="st"> </span><span class="kw">read_mrs</span>(fname, <span class="dt">format =</span> <span class="st">&quot;spar_sdat&quot;</span>)

<span class="co"># output basic data structure</span>
<span class="kw">print</span>(mrs_data)</code></pre></div>
<pre><code>## MRS Data Parameters
## ----------------------------------
## Trans. freq (MHz)       : 127.7861
## FID data points         : 1024
## X,Y,Z dimensions        : 1x1x1
## Dynamics                : 1
## Coils                   : 1
## Voxel resolution (mm)   : 20x20x20
## Sampling frequency (Hz) : 2000
## Reference freq. (ppm)   : 4.65
## Spectral domain         : FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot data in the frequency domain</span>
<span class="kw">plot</span>(mrs_data, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="basic-preprocessing" class="section level2">
<h2>Basic preprocessing</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># apply water filter and align to tNAA resonance</span>
mrs_proc &lt;-<span class="st"> </span><span class="kw">hsvd_filt</span>(mrs_data)
mrs_proc &lt;-<span class="st"> </span><span class="kw">align</span>(mrs_proc, <span class="fl">2.01</span>)
<span class="kw">plot</span>(mrs_proc, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAGACAMAAABC/kH9AAAAWlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQZgCQtpCQ2/+2ZgC225C2///bkDrb////tmb/trb/25D//7b//9v///9uL0JRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANr0lEQVR4nO2dDWOsJhaGT2+bbpPdTbpN7+xsEv//31y/BQQF5Yzw5n3azjiMHpBHEJVJpSHQyNUFILpQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOD7BQiolVnDmg4g8CAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeC81FkHVFwPoqsIwrOR5F1RMH5KLKOKDgfRdYRBeejyDqi4HwUWUcUnI8i64iC8+GdHnM1FJwPCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgZHSqwlCs4HBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4FYyNF1hIFZ4OCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwZGmxGqi4GxQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDYyvxQFBeeCgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGh4GtR3wEKvhYKTk+rCgpOT6sKCk5PqwoKTk+rCgpOT6sKCk5PqwrtHZCH5JLO9xGsvAcUfDEUnJ5WFRScnlYVFJyeVhUUnJ5WFRScnlYVFJyeVhUUnJ5WFRScnqaDTk6ivQcUHAsFZ6U4wUpdKQUfSFOBgvNCwdkyWF5L4vsIVt4FCo6EgvNCwfkyaCg4AgrOS3mCdbKi4ANpKlBwXig4XwYNBUdAwXkpTbCWCAo+kKZB5YLLM0zB+TIw3sqBgrPFt96LgYKzxbfei4GCs8W33ouBgrPFt96LgYKzxbfei4GCs8W33ouBgrPFt96LgYKzxbfei4GCs8W33ouhQMEqeVHwgTQNKDgzoIJXISj4QJoGFJwZCs4DBUdCwZkpTLBkyssNoTV2W2VIwdtQcG5QBTsxKPhImgKZBK+mZlLwkTQFNAVr7oOsFkqBgrNAwZFQcG4oOAviWSoDCs4CBUdCwbmh4ById7EIKDgHFBwLBecGVbAThIKPpClAwbmh4BxQcCySJzMKnqlT8N4KFDxTpeDdP5ZGwTMUnAEJLJcApGBZxaDgI2kKUHBuKPg0QsHxVClYKDgaCs5NjYJXY2RflIcJdkpDwZvUKXjj4+WUJVi2M1u+puBYKPgsFJyAR7BnmYIT+B6C4wbnh3CDUvAWe4JnURQcCwWfhIJT8AkW41sKTqZIwWZuhQtexaTgLSg4O6ULFs9y0YJLM1yX4FkdBccCK9g3FFfYCQpOwid4+WAI3i4PBS8gCl53yGqCPREpeANXsFDwWQoX3F0kiZFagmBP4NDXBVC4YMvmtYLFt0DBabiVaL1ZI+grBIsTmIKTCQhenF4peO5OZE6g4EQcwdZg+nLBzVrwdTUVDQUnlM0R7J++S8FhxFkqSbCR8zzY88aj4DDiLBYt2H8GpuAt9gUbHeVeGCXBc9sNBaPgMGHBplgKTqFUwUubnT7O2goQHLhCOp2JAiULtj+K874XRlVwaIR1MhMFKDilbEv/QcEHEOfDluCtAlGwAQWnFI6CT+EI9n68WrDMHyk4GTsPKUqwk/uG4MIMFyzY+VSY4HAsCg6xJXhVs7sV7BF8Yi8o+DzbWSQLNtfIJlgo+Dhxgve7W03By2cKTmXnbyO5314iOCn/MihG8F4GFHyMagTHr1++4EceAtUKDm0gmQWHTvm7l2kb31PwiQ1E1jbdAdqBbDIK3rhHogCaYGlOC7ZavjsX+njJzKAp0Q7lsb3iFYLT44cEe/pjCj6WlpPjnWc4ce01JhexBQ/bUPBZChJsNX11wZ5+JiqP2LXLEHzooD4gOCYbMbeTZnsCVnzBvBksK0vi4Lo2wUeuHHaLeUiwNI5gO+lwybwZNOat9ZSjPH7dQgRn2GjdlZYoeAhpFGgaxKX1ExRsfUgU7I7Dk08g/tO2SLMIFjMxVfDWjCFvWQ6m5SH5FDdvuAqTQbAssRrXQlrJ3G1GteIItjqJyHxShgVFCD4WfC14NY9rvWbU6XEl+EDRVgeFNPOQbR5zTIWe5CYJjlu5AMFH7826MsU9VNIFO7OuNQQ3K8EiiRmJP4PgyofTshBfVM+WThgn0AHBdk0f32lPtzQJNjISKzE6x+Xwi1i9YsHWHro1NaY5C7tdtCX4xD6vT5KL0cYQnFY+e516BB8Nvn6wIO4K42pu0kZZjKWT++y5oWFd9R6u5+8k2DFblmAx9y1ScIoziRmgFiH48KY7s6SnSk0XfOa4m0NMgperGs8fv94oQzDwEgJc8GJhS7DzfCiuKCeGBksIaeYLobXgQPT9TI2hRQWCz8QdLynDYTyCtzJ0BZ8omhFk+sfJIhhdgh/cNHzB8+tGa3Cb4iWCI6bre0uxIzjGcP2CN1yM3+wLXvfzeSZOydR/WEOtvY1kfveWoh7BGQYyY5htwbY5b5WtV8sj+MipfHn+sC94v5wXC87TTIJhfDOq/FXmHmz5BB8INI0dKHgvzP7fGpwNuFGyTF7eGABubybN8q8v5rz4HQRv7WSdgo0z92rj1TVfuYIPPwj2BUpZ3f3gF3y2VGewbsI6x12xgtfHYq7fcBx5Hm8Ma8VeMFa6kpDgxhW8U9KHCV5byCY4tXBG17GMY9x+/mrBE6FJtqu0QIEfIrhvMj7BZ4KewBIsfsGlYM1B8BZRXfBuxQSG89cLNq9DChY8lDV4xaUmWMJfuSt6r+gurNB5lGqe0AoVbMzD9JdQ5hU3vo1PW75c/i8VnpXtE4d3wHyl4OkGcfmCm3lKXrCPkWW1wJcJadYDr8BUVUfnXL6IbB5EnYJDBcwl2O3UfP3cJNgcGgS68ivrcxS8O0AtgYhJtVv3LOMFr6YAepy7bSP4JCV4QnkQtQneKZyaYCeyOKuJVbjSBK9GCqUSUVnh3zpEC561iRg9wrw0phmPP43R3zosBacQeQl3WrB5ZjUF2+12abBLL70Ke/j3Ktm4vAAJnPgRQ0IXbWQkjTF1W5yT/CxYnMKJ6fr6+i111OwhQfDql9aHBDdiC5476c0wTvu/un6vzj+ByKKuh7yBbSMEzzfQ/KfYQJh5EwpWwTfgThJsdb9uDxxXgqlLv76DvLwA+SlAsN2zk8xMXqZKbo4KNhZSW/ByGicqOGOiNMHrj4c9UbASeQSTYrHuS0TMK91II0Vi3zCmYDiWq9DQDWoKrhrjNgMFI2JfDVMwHPb0PAqGg4LBkY1PaWmkSCj4W0HB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBECyaVckJ6XpjDw3KgYPAcKBg8BwoGz4GCwXOgYPAcKBg8BwoGz4GCwXOgYPAceN8ZHAoGh4LBcQV/vnRPJX5TzvX91/9qhr+J/PKXZgZfb20lPWvm0PLxj58ZoriCP35XrZmBu6gKvv342dw1DX+9tdFvys3g8+WHhuB7lqjbtL2EpuDPl+fOgWL1fzy9NsNxpMddREXwTbt37vL49U/dLrpRFjyg2knc5TlPW3MFv/+hfnZpzwLK5+CWm+5JuONdubNTEfz50lX9u6bhr7dn7UFW179pD4G6NqacgUoLzhg6wK2Vq9+Cv97UjyHtc4Ci4GEQoUM/TNcXrHuGfED71RWseK10GycA6h1CA5oHabcX6n51BA/Von6tpNqCH7APN/Xjs9Fqwe/dmUV1kNXnotpFd9G7oZwaH0/67Veti35/QPepfQ7W3ofxNKN8JaZ4DiY4UDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8Hg1CO4n2zePYX6fNl6UuT9dk7s5/V3T2mmlP79JvJ8nzb7ett7EPX5zwfMHc9FNYKHOTLvv/y1I9jLtMm9f4roBukmUi+fIyYO3/VnHGWjFsHjDJxuLt0Jwf10hn7OtC341Wzj+9H3G3k51CL4Njaa//1sFfzraXigfxvmcH88/bvteZ8/+tRB0G38gdX46H+0ZsyGn4K033Tbydj9D4/ZP37/z9MQeV4ws1hKUwGVCDZ/qPD50v0yaPyvmz3z8dT/VKg1c/vxczip9p3wc99ib0aHvMx1nYJMrXduuN0mrcfXvjs3Fows1Kds5qQSwf3vjczltsse0toW10+RGl9eB1vD2v1oqOvcZ31dE+xnwixBbMFjerd920zthSkL7SmbWalS8NDpDs2oreulzkdjZv3fl357oB2NT226fVkLnv218e2F5cUsTuFUItjuokfB0wzrteBpXnd7Kv7x99OrO3J6H3tyj+AhTL9953VeoGBlpmFNe0K0W3BjVrzTgucvRn1T+n0494ZbMAU/HPcyaXSzfGcKnuq/n3h6X7roqR+4h1uwcQ5+n87B/cKrk8+D9/8wtQgebnT0P62f3Aw/EX13mtc8im5tDo1XltsYw58WuE8pluCxTQ6j6Hb7efA8LFhuOYpWoL/LON+qnG4xdmPiteDpOrj/Yx3vY4c8B+nsuILbK2bjOvhpvNI2FqwXXgfXizUKD3TFB+6lXQYFu9x+2xXMe9E18/X2uiOYT5NIOVAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOP8Hgp2FAjZZ54QAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="basis-simulation" class="section level2">
<h2>Basis simulation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulate a typical basis set for short TE brain analysis</span>
basis &lt;-<span class="st"> </span><span class="kw">sim_basis_1h_brain_press</span>(mrs_proc)

<span class="co"># output basis info</span>
<span class="kw">print</span>(basis)</code></pre></div>
<pre><code>## Basis set parameters
## -------------------------------
## Trans. freq (MHz)       : 127.786142
## Data points             : 1024
## Sampling frequency (Hz) : 2000
## Elements                : 27
## 
## Names
## -------------------------------
## -CrCH2,Ala,Asp,Cr,GABA,Glc,Gln,
## GSH,Glu,GPC,Ins,Lac,Lip09,
## Lip13a,Lip13b,Lip20,MM09,MM12,
## MM14,MM17,MM20,NAA,NAAG,PCh,
## PCr,sIns,Tau</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot basis signals</span>
<span class="kw">stackplot</span>(basis, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="fitting" class="section level2">
<h2>Fitting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># perform VARPRO fitting to processed data</span>
fit_res &lt;-<span class="st"> </span><span class="kw">fit_mrs</span>(mrs_proc, basis)</code></pre></div>
<pre><code>## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |=================================================================| 100%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the fit estimate, residual and baseline</span>
<span class="kw">plot</span>(fit_res, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
