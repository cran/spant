<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2018-11-05" />

<title>Introduction to spant</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to spant</h1>
<h4 class="date"><em>2018-11-05</em></h4>



<div id="reading-raw-data-and-plotting" class="section level2">
<h2>Reading raw data and plotting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(spant)
fname &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;philips_spar_sdat_WS.SDAT&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;spant&quot;</span>)

<span class="co"># import raw data</span>
mrs_data &lt;-<span class="st"> </span><span class="kw">read_mrs</span>(fname, <span class="dt">format =</span> <span class="st">&quot;spar_sdat&quot;</span>)

<span class="co"># output basic data structure</span>
<span class="kw">print</span>(mrs_data)</code></pre></div>
<pre><code>## MRS Data Parameters
## ----------------------------------
## Trans. freq (MHz)       : 127.7861
## FID data points         : 1024
## X,Y,Z dimensions        : 1x1x1
## Dynamics                : 1
## Coils                   : 1
## Voxel resolution (mm)   : 20x20x20
## Sampling frequency (Hz) : 2000
## Reference freq. (ppm)   : 4.65
## Spectral domain         : FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot data in the frequency domain</span>
<span class="kw">plot</span>(mrs_data, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="basic-preprocessing" class="section level2">
<h2>Basic preprocessing</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># apply water filter and align to tNAA resonance</span>
mrs_proc &lt;-<span class="st"> </span><span class="kw">hsvd_filt</span>(mrs_data)
mrs_proc &lt;-<span class="st"> </span><span class="kw">align</span>(mrs_proc, <span class="fl">2.01</span>)
<span class="kw">plot</span>(mrs_proc, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="basis-simulation" class="section level2">
<h2>Basis simulation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulate a typical basis set for short TE brain analysis</span>
basis &lt;-<span class="st"> </span><span class="kw">sim_basis_1h_brain_press</span>(mrs_proc)

<span class="co"># output basis info</span>
<span class="kw">print</span>(basis)</code></pre></div>
<pre><code>## Basis set parameters
## -------------------------------
## Trans. freq (MHz)       : 127.786142
## Data points             : 1024
## Sampling frequency (Hz) : 2000
## Elements                : 27
## 
## Names
## -------------------------------
## -CrCH2,Ala,Asp,Cr,GABA,Glc,Gln,
## GSH,Glu,GPC,Ins,Lac,Lip09,
## Lip13a,Lip13b,Lip20,MM09,MM12,
## MM14,MM17,MM20,NAA,NAAG,PCh,
## PCr,sIns,Tau</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot basis signals</span>
<span class="kw">stackplot</span>(basis, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="fitting" class="section level2">
<h2>Fitting</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># perform VARPRO fitting to processed data</span>
fit_res &lt;-<span class="st"> </span><span class="kw">fit_mrs</span>(mrs_proc, basis)</code></pre></div>
<pre><code>## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |=================================================================| 100%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the fit estimate, residual and baseline</span>
<span class="kw">plot</span>(fit_res, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">0.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAGACAMAAABC/kH9AAAAXVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQZgCQtpCQ2/+2ZgC225C2///bkDrb////AAD/tmb/trb/25D//7b//9v///8ViMiLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAV2klEQVR4nO2di5bjKJKGo3umerZqZ7J2Ore9yqkqvf9jri1xieAiLpYlEfn/51RaxkAEfIAAYRfNkGrR2Q5ArxUAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAKxcAK1cOMEGDqRXwrs2FN5w9cnmR6FzzT+kQwGV6VJPxSIAv0xqaAVew6kp0OuCN3AG4kLKMrxJwzUDeqy3AVIjQlNvu2rR1AGCqAlxzn+5rXjURt+0bwPXQ8nObGmdaI+wNmESkBM8oSRFwMqOE7a7mlckqeL9hn4x/AJxOuRdgqqm3MEImRejRZtvZBpwKpcZBnfJZlT7p/TAfznynxMgWV1QqljBETYC34yXcCZukySuI1gU447eppPpufDnAZAHHpWYh5AO2AcfNPVU3VMoq5XcVYNodsBhvKvqA9yPjQlRFvEy5RCnjcfowfAHsDEZ9ypsjC3gju1bAxTthAHT11+fmqzwAHMQhGbsPsP04X0XMa+escFQUS2TE/d0ZsGucxEJ4BOOHmHtmsRCrRxaaGvwrAFM4qhjAQb35mnfWfH00AU76EwGW7TUuGzkTzwGWqToB29onVwti5HSASZStCbA0IAoSliaoOgeYdx6PnA+azLAHTD7pzBxLASaTMjHYSMBRnKhT2z1jWXeyYESy1fumwMocQdgFMJFvgYGTvjtl88sCpsRo62C4+LKrs8KSb3kcJSuFf+dvOLbyA8CJSqcSYN59Ay/nIDcGiHjtOi9MgVKAaZYltYHWsV7AvluQGLN5z+FrqpQxSkRhHwSV6psTL2EZMO8xRD4piTpyteKSuhieh+/brLmx1iFyc92YxOzffczHItcQ0oBtRbFS2ArmbVQ0VJtFD2BmdnaAGVBni+UeAGZwAmKeufyUNydbdbMvNKspC5kD9g4yZ3he9sWPOy7/ELDv0ER8cAxy44Bdhfg2y/q+rSzRMh1Q8pXp2svMjDoc7O7kus4TjwvFeOAadABYJOTGOKQEYJ4osBwC5mOAH1tYFbiOJwN41YWAWf7sra06XvOiebOW5FyRbZ8Bdjn4hDnAbJDw/XyW8LwzHDCvvxzIXDirVl5hzpMIMPkRJA3YIWwA7Erl0dhUfgjJACbvaQ6ws+ffeKeJZ8EYsmGC9+AEYBHkGpQtF2tkrA8wwAEZ571r8hTHksy2wqMIzCgbZFMu+DoP2liUSPROfiHbua9870nsJKtK/55Fcj1wtezaY9DJXR9mJWa9h+a41B4lRc4x5ryfWlvCYwk4lG8aJEOTag0XXXpjXCB7j/QdawMwr0MRy42MLgK/p6W9zQGWBXCAA6f4uOGd95jygLnxxKAZWXJ3Ot54fVzZp6PyvQ4w93QDMBu1ohzjkScL2P71lZICHFkX/SHpf5RJGjD7xBWMJ+dWmQGK+IfuMMDcro+aGp65hXk4wEQymhvwWLWKwS9rPd3FpNdyALUXxF/CccH5NKeKXgSc8ISZiYxt5UBxmj0Bh3ZSUTzgRKQ6wD4aB8xKXgCcLUJoR4SK7h1+HDSHRAR7+RzgjA9bnx0MmLNJZhEklQOWjxUCLjVtF6sdsDeZ/TTMY+PDZsBNJl4LeNMO/yBfkanqTwxsFF5Gi7Ks9c0BbiPpLoBrtW3rAoA3B8ltwMk0RcD1bm0OcFsfHQm428RhgPMeyD81uftR+ml/qvp5JuUYgOtjvxJwR5Lt++aLPWDJALig0QFfQW2uHAy4Q9sWAbgz9nUAX0MXKjcAv0LDlhuA6zRsuQG4TsOWG4DrNGy5AbhOw5a7GTA0mHYCr1sDlxqAK7T1hOLqAuAKAbByAbByAbByAbByAbByAbByTdPZHvQLgCs0DUwYgCsEwMoFwMoFwMoFwMoFwMoFwMoFwMoFwLo1AbBuAbByAbByAbByAbByAbByAbByAbByAbBy3fGOSxiAywJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg3XrABWDFAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlAmDlWuAOSxiAiwJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg3VrRArBaAbByAbByAbByAbByAbByAbByAbByAbByAbByAbByAbByAbByAfAROrF+AfgInfhfNAPwEQLgXgFw2bT/O6AAuGza/x1QAFw27f8OKAAum/Z/BxQAl037vwNqDMATAPcKgMu2/d8BBcBF0/xlPAFw0TR/GU8AXDTNX8bTKIDprBoG4CMEwN0C4KJp/jKeRgF8Wg0D8BEC4G4BcNk0exlPAFw2zV7GEwCXTbOX8QTAZdPsZTwBcNk0exlPAFw2zV7GEwCXTYvX0QTAZdPidTT1Az4SNQB3C4DLpsXraOoHfGSBzwPszH42wMc+gQfgbj0B+MASA3C3ALhoObgYTABctBxcDKYhAD9MAXCfALhsWl4MJgAum5YXgwmAy6blxWAC4LJpeTGYOgEfO61dTJ1TwwB8hAC4XwBcYVpcDKZ+wAcWGYD7dTXAyUwBuF/XA5zI9TzA3igA7yMA3lkXA5xeXgNwvwB4UwC8swB4bwHwpgB4ZwHw3gLgTQHwzgLgvQXAm/qsgF9W4+mf0wHgfgHwpgB4Z6UfQwJwvwC44E7icig9AfgVZQbgvQXABXcSl0PpWoAzqy8A7hcAl/yJL4fSMYBrfw0AgHcXAJf8SV0PJAAu+ZO6HkgjAH7ZnL3Kn9T1QALgkj+p64F0EOBKwhcDLEwC8JaRHQCfUMMAXG0EgM8SABfcSb8ZR12AW2scgM/T9QDH2QLwEwLggjeZd8PoOcCV3AD4PD0DuLrMQwIOD3gC8JaR8QBHB3gBOK/qsfw6gB94KQg50Px+OghwJeErAQ6HHQDOazzAdPc4cBmA83nU/ixeZoPsBMCJFgnA+TwA+DwdAXiq/dW0iwOufap9Ke0KWCYiAL6AdgUs3w4MOGUKgMMbLQBfQT2AXfEjwGng6YeACV0a8KCzrP0B87mzjwbAJ+lJwCya/e52vDgaDnDa0icELMr8oP14H995AfhEAXAkAuAtwIm5MwCfqN0AP9i+GvAx65TUz8AwNwbTjoDJ/CX3WR/gMG5m0v6ssrkBcDVg1iWvCNhlFz74TRcegE0AOxvPxtya6rkAYMqb+fSA7Qv57cwLAya28SYAZ2/1nxMwm1LZ1zEAs9/UY2c3iPKnTz4N4GhcXq/sqwnzVKkWMGskqeC9AXt7/vgVbRxN+IyAE5U/HmB+gHLr9BgA26tgcL444MkAJuMqAEvAbM7swtxa8rqAiQGelyOUZnaR/zGCzwxY7g08qina47ggYHcbWfotANtwvYCXsQeAI8Dh7jy5qTQDXFE/1wBcdG8stQOmIuB5Sh3muBZgNy8w/4gA2IRHw3G8O09usTEG4GWWZZrppwdMIWCao80Bcney4Ha8rXMBZ58ixY6MpHbAspjLjl9YcD9RuRpg7lgIuPi8+ZMCTmz+XB+wX6db0gBswhOAE5H8x3RtwN65aWMTazf7x6t9khXdcOOoLEhOqDflI4RtKBncpU3ApRNBnxRwKtKegHPce0R5wPE3vrc8HEfHAc4kdFHpHMDeTQBewqsKeVnA1hv/sN+5WfGbxw0OHHMAtEIHAPaXW1Hp5YCnVdmsAHgJ76/lSwDmzzFzrmxlUWsMgENDlCPJg9uqTcaeJrbR+mLAVPsT922ijoZzHcDs470Ai+gGsN/DyrqSVx/g3WAfAfiJYTJdqWTt7Q6Y5E9KcMC9zbQyGc0ZwE/eZC4OOD2zcbPZGsBN5ZvCbMg99e0FXJkuBmyfji/pe3s0DQjYQXgN4Im/sxV0BOBZArZHxVeXem/QxwBuNcDTsnUKCzL2yoDbxuhJ/vSLA0xT7W/CxFrW0Vu/6ua7qP23cFmQTvbRavWP74bWKay+mkSN4U/dRCLAbtlCWahPAhbPtcjehbsBJxopc8l+aOCanmp+95JWD6b4Z06rrccdpMblfcLrjUl47hxFTa9tBcwT7ARY9mHfTVcT62emya5TadMmzCTPZNBcjWQySpyuKKfcJbze2LOA6zwgA9jvRc6mmpYzKb0DES0HqCkF2M6gzDhqZnS225mebU8G9QCe7LmTxrXEPuG11iha8KbO7Yme1wfYLncDwEsl988UifzxvFkAnsx2NpnvLTLApheTA9w4W5zN3HDNv9H7HQBTrLw1kg8V6CWA/SgsTv9ZF55opGaQ94DJDkvmRrvmb3EaD8z92ERgp4rr7ZKbfzeOP88CTtPMUaZZHG4zvYyi9Ye8d7Lguhkof6gQA35GIWAzQ7bdd+3iM1vx2hHVfOaoyz5cdIqIDUGHAd7qq+mPU4DJnHjj8fjXUikIrwIcJd8P8Pq6Zkzke6RbExl7/tbrEvo/QR9uA9w0SPcDrhrpAsa1gGcWJQBccw8KbgLz3NboNxTcOdj8ya6JmBOr4kZuPk1lm7fL7zEt07ROwA2PS3hUt3BY3vlhtAVwxSInnIQ3jmobcs6QWbKsDMnd2UlEJYpHHN/FKQzbsOsLYPbTXwq4dZriT8qkAc9RF/M9jwLAFWv9cCH21Lw5I3I9145LIWD7LldXvCCl+uQTq9cD7pmF8hGM/BpmUR4wRf/5yTS5pXMkOfL7jJ5bGGVlht+Aaz1gt+81z+nWwfPh/pO9rVWpGXD3IoNcaYlY2Wa7GhaRl1kLxZOqyawqUwYm0WJ8Ro2zkmoR2/3PAC6lN7UQ38ADhTfsVwKuyzadliRgP9WNZ0FmOhXPmvkqxcee2XOLeEn9IsB+UtwFeHaM7aoyu0SIZmT1Y/SRgG1TtesnBjgi4L8tFFmMAZu93uR3KF4HeBaF6M2BJr/Kym3CSPeXmNVbJccCng1dP1w/lAI8T35zKHYhXDWbCY/dvZIfFu/Aia24il25PQDPpjTTtAV4Ggrw7HqwWDJGkSZX7JQPQSedHeAE/Y0OXELo46Qi7gKY3Yo5YJZtCNNOP2uz3ye8TSS7Zn7hUwvYbYEkx+9U7hVo02m2e3b7QGD3l+0TiqjdhO18/by2C58D2N+HS9FyoeFexrxOuusAd7BNONEGMh+P3Di9IiY524oGMrLhdW7uFN4qqutDGcC2sy7ygCk5owruYHvA3UERa7e28IDX+XIGZOU2yXmAzfqis7qJr7LsEiMN2PncMyofIcuZ7X3awXpr224MwHNnn2Kbd3ZgI7tBnMrtomy5VsxTqKzb1wYcZNRc/fZwEplHK/Zgamr2MQDcReZOIzBvPB4dCnA7BfuEdAXsDlYkftNpDLpW6x3YDtqbzttHzWMAXsIaWJA5Y2zvwKv8dpbNcCi6s5l9csz5qJOffWzmt0v4Xqom4lYW4QNjP3INB/chDtic8ctidtsj2/ntEr6jqlfI9rAik5t1jkl3lbnhiAVxmvJkDhtsZbZT+L6qwGMHsTkBeGS6D9lHD/MsKzzuzG77ayOvfcJ3VwWjBOB1y/JVPh0lDjjxKadsjpXki3xZwDWIU09fxsdbArxGsZTFJnYiyYUBlyfBEWAFvfeheHDOxFsqyD13Gw/wYnBz+BEnNnXQdapdTpDfxXabsv7v5QHPG+g8YG1wG+Ug2/f+7wiAF7vpdYJdKJ7g0dXktjjJtvyhAK/GUzrToStpQcqGa3EoMBG9MfwsXc2fE+V2v9yzis3FVmP4WbqaPyfKArYD3fbTRgAeUWbrx3wjecWcjdoWfpau5s+5coDN241vuwPwiLJ9170f/x4McSW+4wTAmgTAypXaCspFbQyHriAAVq49niZBg6kV8HYTKmjY1MM6fvAQPWzqYR0H4MubBuAjUg/rOABf3jQAH5F6WMcB+PKmAfiI1MM6DsCXNw3AR6Qe1nHsOX9WAbByAbByxYDf//Z/5uqD6Lc/WzK7sQQ/vz0ecfy9M3Wz7V/f79a+dtoWiduLPc8//vFXp2mZut32R6nKI8AfZAF/3FN+tJi7/f6XT/Djj8ZKEqlbbf/6fo98s4VrtC0TNxf7UbO/W0TNxRapm22LBEnbIeB7KzCAf31/tOn3+sb489vXRypbT87rjtTNtn98eZvXNtJhWyRuNr30Io+osdgidbNtmSBpOwR8+9v/GMCyzupNGmu3tmFKpu6z7dpyl22TuN30B331Vdtsmqduti0TJG0HgO+93N6D1w7f2iJvdrx4/y9+X2tM3Wd7fjcJumybxF2mffQe0x5wq22ZIGlbAn50eQt4bdFtd6MPZ+Dnt0c2701F9al7bC+dodu2S9xl2jHpM21TN9sWCdK2JeDbPcozgB9NxE3C5/Y+aFP31bKcQLbZ/uBzrH7APab3Apy2LQAvPf65IVpaW+8R7al7bH8Eo1OTbZ/4ySG63fR+Q3TStgB8Mwf03nzM5omOMNC8aDCpO2zfwrtPi22WuKvYIeC2Yu81yUrazm90dC5VjLfiTXPq9rXKjXy7arbNE3cskyJEvf3/uWVS2vbGTlbzqvuRcjVprbbMNkTqVts/vnBLjbZl4o6NDj6Lbi22SP3cRkfSdhrwuh69te6bva/D+5r63Y71XakbbZuby29/9tgOEjcX2yDqLLZI3WzbJMjbxsMG5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5RoI8HI8/fEs8+e3rcc1yU+DQPt2eb0Rff2wH//6XnoU9PO/m08+n6lxAK+nat5/+7MAOKkM4PX6K3tfcez1g586u7yGAWwO8zyO5e0N+M2/r8m63MmvpGEA30y/+c9fdwr//LI+2b6tB4F/fPnXt/vFjyV0ZXQz39Ixz8AtuEeUJc4/bdwlxIz967P3H3/8+8uarbvg+XtXhtAogN03JuYHrcd3icy/x3mbH1+WLxfd4dx+/2u9ry4j+dflFMvNj+rLMPBBbzYH23tdx33Ev3N8e0TiFyz/9qPEp2oUwMtXl/j1ndUadu90y6Eq8+dtBWaOwD8mRA+qhqA9/eRzkIBN+CPxvZvKC5t/x2HgMzUm4HXQXXvSvbp9tRtoHMGHH7fdF/lsDjFgx++eubzwf7gvl9cogOUQbQDbY9wxYHs4+H4r/v1/fQ9el1pvWcBrHn+Yrwv4CwB+vezMZrmD8h4887oPerD7gM+O39d7b74HA/AZCpdJBo//jAO2CJZ77gdJwDZlErC7B7/be/By8RYYObToT2kYwOtGx/JlfItn/bbpe9DD3Cz6PqqvnZfcTsbS5z9SPZgd11/mzG7yvF4ItphFv0bLT1C4rUq7y/hYvMSA7Tp4ORdux+R5mXERayKu977zdfAXs8xmF+IP1sHjSkzBM0Nxx0baiQJgqdvfi4CxFz2yfn1/KwDG0yToSgJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5QJg5fp/m7Qpd8wzb/cAAAAASUVORK5CYII=" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
